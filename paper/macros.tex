\usepackage{amsmath} % Needed for \DeclareMathOperator
%\usepackage{amsthm} % Needed for \theoremstyle
\usepackage{relsize} % Needed for \smaller
\usepackage{stmaryrd} %% for longarrownot
\usepackage{amssymb} %% for \sqsubset and similar symbols, and \varnothing
\usepackage{mathtools} %% FOR \colonneqq
\usepackage{prooftree} %% to write derivation trees

\usepackage[dvipsnames,svgnames]{xcolor}

\usepackage{minted}
\usepackage{listings}

\newcommand{\codefontfamily}{\fontfamily{\ttdefault}}
\usepackage{ifthen}

\newif\ifhidecoq
%\hidecoqtrue %un/comment to hide/show coq code

%% \ifhidecoq
%%   \usepackage{environ}
%%   \NewEnviron{hide}{}
%%   \let\minted\hide
%%   \let\endminted\endhide
%% \else
%%   %%\usepackage{minted}
%% \fi



\usepackage{enumerate} %% to define the counters (i), (a), ...
\usepackage{graphics}
\usepackage{hyperref}




\usepackage{diagrams}



\newcommand{\TODO}[1]{{\color{red} TODO: #1}}



\newcommand{\Names}{\ensuremath{\mathcal{N}}\xspace}
\renewcommand{\aa}{a}
\newcommand{\ab}{b}

\newcommand{\co}[1]{\ensuremath{\overline{#1}}}

%%%% Alphabet of visible actions
\newcommand\Act{\ensuremath{\mathsf{Act}}\xspace}
\newcommand\Actfin{\ensuremath{\mathsf{Act}^\star}\xspace}
\newcommand\Actinf{\ensuremath{\mathsf{Act}^\infty}\xspace}
\newcommand\Acttau{\ensuremath{\mathsf{Act}_\tau}\xspace}
\newcommand\Acttaufin{\ensuremath{\mathsf{Act}^\star_\tau}\xspace}


\newcommand{\Locs}{\ensuremath{\mathcal{L}}\xspace}


%% Operator to write cases in a BNF grammar
\newcommand{\BNFsep}{\;\;|\;\;}

%% Syntactic constructors of our calculus
\newcommand{\Nil}{\mathop{\textsf{0}}}
\newcommand{\Unit}{\mathop{\textsf{1}}}
%\newcommand{\mailbox}[1]{\fcolorbox{gray}{yellow!40}{\ensuremath{#1}}}
\newcommand{\mailbox}[1]{\ensuremath{#1}}
\newcommand{\out}[1]{\mailbox{\ensuremath{\overline{#1}}}}
\newcommand{\intc}{\mathrel{\oplus}}
\newcommand{\extc}{\mathrel{+}}
\newcommand{\extsum}{\sum}
\newcommand{\intsum}{\bigoplus}
\newcommand{\Par}{\mathrel{\parallel}}
\newcommand\ppar[2]{#1 \Par #2}
%\newcommand{\Bot}{\mathop{\Omega}}
%\newcommand{\rec}[2][x]{\mu #1. #2}
\newcommand{\rec}[2][x]{\mathsf{rec} #1. #2}
\newcommand{\Rec}[2][x]{\rec[#1]{#2}}

\newcommand{\send}[1]{\mathsf{send}\ #1}

\newcommand\CCS{\textsc{CCS}\xspace}
\newcommand\ACCS{\texttt{ACCS}\xspace}
\newcommand\TACCS{\texttt{TACCS}\xspace}
\newcommand\Api{\ensuremath{\texttt{A}\pi}\xspace}

%\newcommand\Proc{\States}
%\newcommand{\ACCSin}{\ensuremath{\textsc{ACCS}_{\mathsf{in}}}}
%\newcommand\TACCS{ACCS}



%% Client-server system
%\newcommand{\csys}[2]{\svr[#1] \Par \clt[#2]}
\newcommand{\csys}[2]{#1 \mathrel{\llceil} #2}
\newcommand\pl[1]{{\color{violet}{pl: #1}\xspace}}

\newcommand{\GBx}{\color{red}}
\newcommand\gb[1]{{\GBx{gb: #1}\xspace}}
%\newcommand\gb[1]{{\color{red}#1}}
%\newcommand{\gb}[1]{#1}
%\newcommand{\GBf}[1]{\marginpar{\GBx~\bf\fbox{\footnotemark}~}\footnotetext{\GBx  #1}}

%\newcommand\ila[1]{{\color{blue}{#1}}\xspace}
\newcommand\ila[1]{{\color{magenta}{#1}}\xspace}
\newcommand\ilac[1]{{\color{orange}{#1}}\xspace}
\newcommand\ilacom[1]{[{\color{orange}{{\bf Ilaria:} #1}}]\xspace}

\newcommand{\leo}[1]{{\color{green!50!black}{ls: #1}}\xspace}
%% reference commands
\newcommand{\rfig}[1]{Figure~\ref{fig:#1}}
\newcommand{\rpt}[1]{part~(\ref{pt:#1})}
\newcommand{\rPt}[1]{Part~\ref{pt:#1}}
\newcommand{\rtab}[1]{Table~\ref{tab:#1}}
\newcommand{\rsec}[1]{Section~\ref{sec:#1}}
\newcommand{\rapp}[1]{Appendix~\ref{sec:#1}}
\newcommand{\rsub}[1]{Sub-section~\ref{sub:#1}}
\newcommand{\rexa}[1]{Example~\ref{ex:#1}}
\newcommand{\rcexa}[1]{Counterexample~\ref{ex:#1}}
\newcommand{\rdef}[1]{Definition~\ref{def:#1}}
\newcommand{\rdefpt}[2]{Definition~\ref{def:#1}(\ref{pt:#2})}
\newcommand{\rdefptNOPAR}[2]{Definition~\ref{def:#1}\ref{pt:#2}}
\newcommand{\rprop}[1]{Proposition~\ref{prop:#1}}
\newcommand{\rthm}[1]{Theorem~\ref{thm:#1}}
\newcommand{\rcor}[1]{Corollary~\ref{cor:#1}}
\newcommand{\rlem}[1]{Lemma~\ref{lem:#1}}
\newcommand{\rptlem}[2]{Lemma~\ref{lem:#1}(\ref{pt:#2})}
\newcommand{\req}[1]{Equation~(\ref{eq:#1})}
\newcommand{\raxiom}[1]{axiom~(\ref{eq:#1})}
%% rule names
%%
%%


%%inference rules
\newcommand{\rulename}[1]{{\footnotesize{\textsc{[#1]}}}}
\newcommand{\rname}[1]{\rulename{#1}}


%% weak transitions
\newcommand{\wtrefl}{\rname{wt-refl}\xspace}
\newcommand{\wttau}{\rname{wt-tau}\xspace}
\newcommand{\wtmu}{\rname{wt-mu}\xspace}


%% musti
\newcommand{\mnow}{\rname{axiom}\xspace}
\newcommand{\mstep}{\rname{ind-rule}\xspace}
%\newcommand{\mnow}{\rname{m-now}\xspace}
%\newcommand{\mstep}{\rname{m-step}\xspace}

%% Parallel
\newcommand{\parL}{\rname{Par-L}\xspace}
\newcommand{\parR}{\rname{Par-R}\xspace}
\newcommand{\com}{\rname{Com}\xspace}

%% LTS ACCS
\newcommand{\mboxinsert}{\rname{mb-In}\xspace}
\newcommand{\mboxelim}{\rname{Mb-Out}\xspace}
\newcommand{\atom}{\mboxelim}

\newcommand{\rinput}{\rname{Input}}
\newcommand{\rtau}{\rname{Tau}}
\newcommand{\unfold}{\rname{Unf}}
\newcommand{\extL}{\rname{Sum-L}}
\newcommand{\extR}{\rname{Sum-R}}
%\newcommand{\extL}{\rname{Ext-L}}
%\newcommand{\extR}{\rname{Ext-R}}


%% systems
\newcommand{\stau}{\rname{S-tau}}
\newcommand{\scom}{\rname{S-com}}

%%% ILARIA (14/12/23): macros to be added in macros/rule-names.tex

%% systems (additional rules)

\newcommand{\stauserver}{\rname{S-Srv}}
\newcommand{\stauclient}{\rname{S-Clt}}
%\newcommand{\scom}{\rname{S-com}}

\newcommand{\stproclift}{\rname{L-Proc}\xspace}
\newcommand{\stminplift}{\rname{L-Minp}\xspace}
\newcommand{\stmoutlift}{\rname{L-Mout}\xspace}
\newcommand{\stcommlift}{\rname{L-Comm}\xspace}

%% convergence
\newcommand{\cnvepsilon}{\rname{cnv-epsilon}}
\newcommand{\cnvmu}{\rname{cnv-mu}}
\newcommand{\acnvepsilon}{\cnvepsilon}
\newcommand{\acnvmu}{\cnvmu}

\newcommand{\axiom}[1]{\textsc{#1}\xspace}

%% Finitness
\newcommand{\outimagefinite}{\axiom{Out-Image-finite}}
\newcommand{\inimagefinite}{\axiom{In-Image-finite}}
\newcommand{\tauimagefinite}{\axiom{Tau-Image-finite}}
\newcommand{\imagefinite}{\axiom{Image-finite}}
\newcommand{\outfinitebranching}{\axiom{Out-Finite-Br}}
\newcommand{\infinitebranching}{\axiom{In-Finite-Br}}
\newcommand{\finitebranching}{\axiom{Finite-branching}}

%% Mailbox
\newcommand{\globalmailbox}{{\axiom{Mailbox}}}


%% Selinger axioms for out-buffered agents with feedback
\newcommand{\outputcommutativity}{\axiom{Output-commutativity}}
\newcommand{\outputconfluence}{\axiom{Output-confluence}}
\newcommand{\outputdeterminacy}{\axiom{Output-determinacy}}
\newcommand{\outputfeedback}{\axiom{Feedback}}
\newcommand{\outputtau}{\axiom{Output-tau}}
\newcommand{\outputdeterminacyinv}{\axiom{Backward-output-determinacy}}


%% Selinger axioms for in-buffered agents with feedback
\newcommand{\restrictedinputcommutativity}{\axiom{Input-commutativity}}
\newcommand{\inputconfluence}{\axiom{Input-confluence}}
\newcommand{\inputdeterminacy}{\axiom{Input-determinacy}}
\newcommand{\inputreceptivity}{\axiom{Input-receptivity}}


\newcommand{\fwdfeedback}{\axiom{Fwd-Feedback}}
\newcommand{\boom}{{\sc Input-Boomerang~}} %%% Ilaria: to be added to
                                %%% some macro file
\newcommand{\accSym}{\mathcal{A}}

\newcommand{\F}{\mathcal{F}}
\newcommand{\R}{\mathrel{\mathcal{R}}}
\newcommand{\T}{\mathcal{T}}
\newcommand{\U}{\mathcal{U}}

\newcommand{\Fwd}{\mathcal{F}}
%% subscript or subscript to denote the LTS by Honda and Tokoro
\newcommand{\hondatokoro}{\mathsf{ht}}
\newcommand{\fw}{\mathsf{fw}}


%%% strong transitions
\newcommand{\stout}[1]{\ensuremath{\mathrel{\overset{#1} {\longrightarrow}\!*}}}

\newcommand{\sta}[1]{\ensuremath{\mathrel{\overset{#1} \longrightarrow_\fw}}}
\newcommand{\Nsta}[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\longrightarrow_\fw}}}}

\newcommand{\stHT}[1]{\ensuremath{\mathrel{\overset{#1} \longrightarrow_\hondatokoro}}}
\newcommand{\NstHT}[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\longrightarrow_\hondaotkoro}}}}


%%%% weak reduction ⇒_ht in the LTS by HY
\newcommand{\wta}[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow_\fw}}}
\newcommand{\wtHT}[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow_\hondatokoro}}}


%% Negation
\newcommand{\Nwta}[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\Longrightarrow_\hondatokoro}}}}
\newcommand{\uwta}[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow_{\hondatokoro\not\ok}}}}

%% Derivatives after a trace
\newcommand{\aftera}{\mathrel{\mathsf{after}_{\hondatokoro}}}
\newcommand{\afterua}{\mathrel{\mathsf{after}_{{\hondatokoro}{\not\ok}}}}


%% Obvious acceptance set
\newcommand{\da}[2]{\mathcal{\mathcal{O}}_{\hondatokoro}(#1,#2)}


%% Convergence along weak traces in the LTS by HT
\newcommand\acnvalong{\Downarrow}
%% Usability over the LTS by HT
\newcommand{\usba}{\mathrel{\textsf{usb}^{\hondatokoro}}}
\newcommand\set[1]{\{ #1 \}}
%\newcommand\setof[2]{\{ \ #1 \ \mid \   \}}
\newcommand\setof[2]{\{ #1 \ |\  #2 \}}
\newcommand\multiset[1]{\{[ #1 ]\}}
%\newcommand\setof[2]{\{ \ #1 \ \mid \   \}}
\newcommand\multisetof[2]{\{[ #1 \ |\  #2 ]\}}
\newcommand\parts[1]{\mathcal{P}(#1)}
\newcommand\pparts[1]{\mathcal{P}^{+}(#1)}



\newcommand{\mset}[1]{\{\!|#1|\!\}}
%\renewcommand\mset[1]{\ensuremath{\hat{O}(#1)}}
\newcommand\str[1]{\mathsf{lin}(#1)}
\newcommand\stri{\mathrel{\mathsf{lin}}}
\newcommand\Str[2]{#2 \stri #1}
\newcommand\occ[2]{\mathsf{occ}(#1, #2)}
\newcommand\emptyMset{\varnothing}
\newcommand{\msetsize}[1]{|#1|}
\newcommand\perm[2]{#1 \mathrel{\mathsf{perm}} #2}




\newcommand{\eqclass}[2]{[#1]_{#2}}
\newcommand{\quot}[2]{#1_{/{#2}}}
\newcommand{\occur}[2]{ \#( #1 , #2 )}



\newcommand{\porder}[2]{\ensuremath{\langle #1, #2 \rangle}}
\newcommand{\seq}[1]{\ensuremath{\langle #1 \rangle}}
\newcommand{\cardinality}[1]{\mid #1 \mid}
\newcommand{\poset}[2]{\ensuremath{\langle #1, #2 \rangle}}
\newcommand{\modulo}[2]{{#1}_{#2}}


\newcommand{\union}[2]{#1 \mathbin{\overline{\cup}} #2} %% Set -> MultiSet -> Set
\newcommand{\intersection}[2]{#1 \mathbin{\overline{\cap}} #2} %% Set -> MultiSet -> Set
\newcommand{\interminus}[3]{\intersection{#1}{ (#2 \setminus #3) }} %% Set -> MultiSet -> Multiset -> Set

\newcommand{\FinMultiset}[1]{\textbf{MSet}_\textsf{fin}(#1)}


\newcommand{\coqbasepath}[1]{https://shouldnothappen.com/must/src/#1}
\newcommand{\coqpic}{\includegraphics[scale=0.1]{index}}
\newcommand{\coqlink}[1]{(\href{\coqbasepath{#1}}{\coqpic})}


%\newcommand{\myshow}[1]{#1}
\newcommand{\myshow}[1]{}



\newcommand\coqAux[1]{\myshow{\coqlink{Must.Aux.html\##1}}}
\newcommand\coqSyn[1]{\myshow{\coqlink{Must.Syntax.html\##1}}}
\newcommand\coqSC[1]{\myshow{\coqlink{Must.Struct_congr.html\##1}}}
\newcommand\coqSys[1]{\myshow{\coqlink{Must.Sys.html\##1}}}
\newcommand\coqLTS[1]{\myshow{\coqlink{Must.LTS.html\##1}}}
\newcommand\coqConv[1]{\myshow{\coqlink{Must.Convergence.html\##1}}}
\newcommand\coqMT[1]{\myshow{\coqlink{Must.MustT.html\##1}}}
\newcommand\coqDer[1]{\myshow{\coqlink{Must.Derivative.html\##1}}}
\newcommand\coqBar[1]{\myshow{\coqlink{Must.Bar.html\##1}}}
\newcommand\coqEq[1]{\myshow{\coqlink{Must.Equivalence.html\##1}}}
\newcommand\coqNorm[1]{\myshow{\coqlink{Must.Normalisation.html\##1}}}
\newcommand\coqCom[1]{\myshow{\coqlink{Must.Completeness.html\##1}}}
\newcommand\coqSou[1]{\myshow{\coqlink{Must.Soundness.html\##1}}}
\newcommand\coqTS[1]{\myshow{\coqlink{Must.TransitionSystems.html\##1}}}
\newcommand\coqME[1]{\myshow{\coqlink{Must.MustEx.html\##1}}}
\DeclareMathOperator{\opMust}{\textsc{must}}
\DeclareMathOperator{\opMay}{\textsc{may}}
\DeclareMathOperator{\opFair}{\textsc{fair}}
\DeclareMathOperator{\opCmpl}{\textsc{cmpl}}
\newcommand{\testname}[2]{\ensuremath{\mathrel{{#1}^{\text{\smaller \ensuremath{#2}}}}}}


%% MACROS BY MATTHEW HENNESSY
%\newcommand{\Must}[1][]{\ensuremath{\mathrel{\opMust^{\text{\smaller #1}}}}}
%\newcommand{\Must}[1][]{\testname{\opMust}{#1}}
\newcommand{\May}[1][]{\testname{\opMay}{#1}}
\newcommand{\Fair}[1][]{\testname{\opFair}{#1}}
\newcommand{\Cmpl}[1][]{\testname{\opCmpl}{#1}}


\newcommand{\opMusti}{\opMust\ensuremath{_i}}
%%% PREFIX NOTATION
%% \newcommand{\musti}[2]{\ensuremath{\opMusti \, (#1,#2)}}
%% \newcommand{\Nmusti}[2]{\lnot\musti{#1}{#2}}
%%% INFIX NOTATION
\newcommand{\musti}[2]{\ensuremath{#1 \opMusti #2}}
\newcommand{\Nmusti}[2]{\ensuremath{#1 \centernot{\opMusti} #2}}

%\newcommand{\mustinf}[2]{\ensuremath{\opMusti \, \nf{#1}{#2}}}
%\newcommand{\Nmustinf}[2]{\lnot \mustinf{#1}{#2}}

%%% PREFIX NOTATION
%% \newcommand{\Must}[2]{\ensuremath{\opMust \, (#1, #2)}}
%% \newcommand{\NMust}[2]{\ensuremath{\centernot{\opMust} \, (#1, #2) }}
%%% INFIX NOTATION
\newcommand{\Must}[2]{\ensuremath{#1 \opMust #2}}
\newcommand{\NMust}[2]{\ensuremath{#1 \centernot{\opMust} #2}}


\newcommand{\opMustset}{\opMust_{\textsf{aux}}}

%%% PREFIX NOTATION
%% \newcommand{\mustset}[2]{\opMustset(#1,#2)}
%% \newcommand{\Nmustset}[2]{\lnot\mustset{#1}{#2}}
%%% INFIX NOTATION
\newcommand{\mustset}[2]{\ensuremath{#1 \opMustset #2}}
\newcommand{\Nmustset}[2]{\ensuremath{#1 \centernot{\opMustset} #2}}

\newcommand{\smust}[1][]{\ensuremath{\opMust^{\text{\smaller #1}}}}



\newcommand{\sqsubsetsim}{\vcenter{\offinterlineskip\hbox{$\sqsubset$}\vskip 0.2ex\hbox{$\sim$}}}
\newcommand{\Nsqsubsetsim}{\centernot{\vcenter{\offinterlineskip\hbox{$\sqsubset$}\vskip 0.2ex\hbox{$\sim$}}}}
\NewDocumentCommand{\testleq}{O{}O{}}{\ensuremath{\mathrel{\sqsubsetsim_{\text{\smaller #1}}^{\text{\smaller #2}}}}}
\newcommand{\testeq}[1][]{\ensuremath{\mathrel{\eqsim_{\text{#1}}}}}
\newcommand{\Ntestleq}[1][]{\mathrel{\Nsqsubsetsim_{\kern-3pt\text{#1}}}}


%\newcommand{\testleqS}{\testleq}
%\newcommand{\NtestleqS}{\Ntestleq}
\newcommand{\testleqS}{\testleq[\ensuremath{\opMust}]}
\newcommand{\testleqSset}{\testleq[\ensuremath{\opMust}][Set]}
\newcommand{\NtestleqS}{\Ntestleq[\ensuremath{\opMust}]}

\newcommand{\testleqC}{\testleq[\clt]}
\newcommand{\NtestleqC}{\Ntestleq[\clt]}
\newcommand{\testleqN}[1]{\mathrel{\sqsubsetsim_{#1}}}

\newcommand{\testeqS}{\testeq[\ensuremath{\opMust}]}
\newcommand{\testeqC}{\testeq[\clt]}
\newcommand{\testeqN}[1]{\mathrel{\eqsim_{#1}}}

\newcommand{\ok}{\ensuremath{\checkmark}}




\newcommand{\bhvleq}[1][]{\mathrel{\preccurlyeq^{#1}_{\mathsf{bhv}}}}
\newcommand{\bhveq}[1][]{\mathrel{\eqsim_{\mathsf{bhv}}}}
\newcommand{\Nbhvleq}[1][]{\mathrel{{\not\preccurlyeq}^{#1}_{\mathsf{bhv}}}}
\newcommand{\asynleq}[1][]{\mathrel{\preccurlyeq^{#1}_{\mathsf{asyn}}}}
\newcommand{\Nasynleq}[1][]{\mathrel{{\not\preccurlyeq}^{#1}_{\mathsf{asyn}}}}
\newcommand{\asyneq}[1][]{\mathrel{\eqsim_{\mathsf{asyn}}}}

\newcommand{\bhvleqone}{\mathrel{\preccurlyeq_{\mathsf{cnv}}}}
\newcommand{\bhvleqtwo}{\mathrel{\preccurlyeq_{\mathsf{acc}}}}
\newcommand{\Nbhvleqtwo}{\mathrel{{\not\preccurlyeq}_{\mathsf{acc}}}}

%% \newcommand{\bhvleqone}{\bhvleq[\textsf{cnv}]}
%% \newcommand{\bhvleqtwo}{\bhvleq[\textsf{acc}]}
%% \newcommand{\Nbhvleqtwo}{\Nbhvleq[\textsf{acc}]}


\newcommand{\asynleqone}{\asynleq[\textsf{cnv}]}
\newcommand{\Nasynleqone}{\Nasynleq[\textsf{cnv}]}
\newcommand{\asynleqtwo}{\asynleq[\textsf{acc}]}
\newcommand{\Nasynleqtwo}{\Nasynleq[\textsf{acc}]}

\newcommand{\altleq}{\preccurlyeq_{\mathit{alt}}}
\newcommand{\traceleq}{\preccurlyeq_{\mathit{tr}}}
\newcommand{\htleq}{\preccurlyeq_{\textsf{ht}}}
\newcommand{\logicleq}{\preccurlyeq_{\textsf{mdl}}}

\newcommand\accfwp[3]{\mathcal{A}_{\fw}(#1,#2,#3)}
\newcommand\accfw[2]{\mathcal{A}_{\fw}(#1,#2)}
\newcommand\accht[2]{\mathcal{A}_{\fw}(#1,#2)}


%% acceptance sets based behavioural preorder
\newcommand{\asleq}{\mathrel{\preccurlyeq_{\mathsf{AS}}}}
\newcommand{\aseq}{\mathrel{\eqsim_{\mathsf{AS}}}}
\newcommand{\asleqNF}{\mathrel{\preccurlyeq^{\mathsf{NF}}_{\mathsf{AS}}}}
\newcommand{\aseqNF}{\mathrel{\eqsim^{\mathsf{NF}}_{\mathsf{AS}}}}

%% must sets based behavioural preorder
\newcommand{\msleq}{\mathrel{\preccurlyeq_{\mathsf{MS}}}}
\newcommand{\mseq}{\mathrel{\eqsim_{\mathsf{MS}}}}
\newcommand{\coindleq}{\mathrel{\preccurlyeq_{\mathsf{co}}}}
\newcommand{\msleqNF}{\mathrel{\preccurlyeq^{\mathsf{NF}}_{\mathsf{MS}}}}
\newcommand{\mseqNF}{\mathrel{\eqsim^{\mathsf{NF}}_{\mathsf{MS}}}}
\renewcommand{\and}{\text{ and }}
\renewcommand{\lor}{\text{ or }}
\renewcommand{\implies}{\text{ implies }}
\newcommand{\imply}{\text{ imply }}
\newcommand{\lif}{\text{ if }}
\newcommand{\lthen}{\text{ then }}

\newcommand{\forevery}{\text{for every }}
\newcommand{\Forevery}{\text{For every }}

\newcommand{\thereexists}{\text{ there exists }}
\newcommand{\thereexist}{\text{ there exist }}

\newcommand{\wehavethat}{. \;}
\newcommand{\suchthat}{\wehavethat}
%\usepackage{paralist} %%seems not compatible with lmcs ?
\usepackage[utf8]{inputenc}
\usepackage{xspace}
\usepackage{tikz}
\usetikzlibrary{positioning} %% for "above right", etc etc
\usepackage{tikz-cd} %% for diagrams
\usepackage{centernot}
\usepackage{cancel}
\usepackage{dsfont}
\usepackage[normalem]{ulem}
\usepackage{mdframed}
\mdfsetup{skipabove=1em,skipbelow=1em}

%\usepackage{framed}
% \renewenvironment{framed}[1][\hsize]
%  {\MakeFramed{\hsize#1\advance\hsize-\width \FrameRestore}}%
%  {\endMakeFramed}
\usepackage{yfonts} %% for textgoth
\usepackage[normalem]{ulem} % Needed for \sout
% \usepackage{thm-restate} %% for restatable %% already imported by lipics


%\usepackage{paralist}
%\usepackage{wrapfig}



%% The next command causes a weird error message
%\setcounter{tocdepth}{3}
%% \declaretheorem[name=Lemma,numberwithin=section]{mylemma}



%\setcounter{secnumdepth}{5}
%\setcounter{tocdepth}{3}

\newcommand{\pierre}{\text{{\em Pierre}}\xspace}
\newcommand{\merci}{\co{m}}

\newcommand{\der}[2]{Der_{#2}(#1)}
\newcommand{\disjoint}[2]{#1 \mathop{\#} #2}


%\renewcommand{\paragraph}[1]{\mbox{ }\\\textbf{#1}}



\newcommand{\trace}{s}
\newcommand{\traceA}{t}
%\newcommand{\state}{s}
\newcommand{\stateA}{s}
\newcommand{\stateB}{s'}
\newcommand{\stateC}{s''}




\newcommand{\N}[1][]{\mathbb{N}_{#1}}
\newcommand{\M}{\mathcal{M}}


\newcommand{\Nfin}{\ensuremath{\mathbb{N}^\star}\xspace}
\newcommand{\emptyseq}{\langle\rangle}

\newcommand{\dom}[1]{\mathit{dom}(#1)}


%% \newcommand{\facedown}{{\bfseries :-(}}
%% \newcommand{\redbox}[1]{\colorbox{red!80!green}{#1}}
%% \newcommand{\sadface}[1][1]
%% {\smaller[#1]{\rotatebox[origin=c]{-90}{\redbox{\facedown}}}}


%\theoremstyle{definition}
% \newcounter{definition}
%% \newtheorem{definition}{Definition}[section]
%% \newtheorem{lemma}[definition]{Lemma}
%% \newtheorem{theorem}[definition]{Theorem}
%% %\newtheorem{cor}{Corollary}[section]
%% \newtheorem{proposition}[definition]{Proposition}
%% \newtheorem{example}[definition]{Example}
\newtheorem{counterexample}[definition]{Counterexample}
%% \newtheorem{corollary}[definition]{Corollary}
\newtheorem{myaxiom}[definition]{Axiom}

\newcommand{\len}[1]{\mathsf{len}(#1)}


\newcounter{thm}
% for specifying a name
%% \theoremstyle{plain} % just in case the style had changed
\newcommand{\thistheoremname}{}
\newtheorem{genericlem}[thm]{\thistheoremname}
\newenvironment{namedlem}[1]
  {\renewcommand{\thistheoremname}{#1}%
   \begin{genericlem}}
  {\end{genericlem}}


%% \newtheoremstyle{named}{}{}{\itshape}{}{\bfseries}{.}{.5em}{\thmnote{#3 }#1}
%% \theoremstyle{named}
%% \newtheorem*{namedlemma}{Lemma}




\newcommand{\koenigslemma}{K\H{o}nig's lemma\xspace}


\newcommand{\Acc}[1]{\accSym(#1)}
\newcommand{\accP}[3]{\accSym(#1,#2,#3)}
\newcommand{\acc}[2]{\accSym(#1,#2)}


%\newcommand{\acca}[2]{\accSym_{a}(#1,#2)}
%%%% Generalized acceptance set
\newcommand\gas[3]{\mathcal{GA}(#1,#2,#3)}



\newcommand{\leaveout}[1]{}



\newcommand{\usb}{\mathrel{\textsf{usb}}}


\newcommand{\eqdef}{\mathrel{\stackrel{\mathsf{def}}{=}}}
%\newcommand{\eqdef}{\stackrel{\Delta}{=}}

%% Definition of convergence predicates
\ifdefined\conv
\renewcommand{\conv}{\ensuremath{\downarrow}}
\else
\newcommand{\conv}{\ensuremath{\downarrow}}
\fi
%\renewcommand{\convut}{\ensuremath{\downarrow_{\ok}}}
\newcommand{\Conv}{\ensuremath{\Downarrow}}

%%%% ⇓  weak convergence
\newcommand{\cnvalong}{\ensuremath{\mathrel{\Conv}}}
\newcommand{\convi}{\ensuremath{\conv_i}}
%\newcommand{\cnvau}{\ensuremath{\mathrel{\Conv_{\not\ok}}}}


\newcommand{\clt}{\textsf{clt}}
\newcommand{\svr}{\textsf{srv}}
\newcommand{\peer}{\textsf{p2p}}
\newcommand{\bad}{\textsf{bad}}
\newcommand{\sound}{\textsf{sound}}
\newcommand{\comp}{\textsf{complete}}



%% Meta



\newcommand\fixme[1]{{\color{red}\textbf{\small{Fix: #1}}}\xspace}


\newcommand\hr{\par \bigskip \hrule \par \bigskip}

%\theoremstyle{definition}
%\newtheorem{definition}{Definition}[section]
%\newtheorem{example}{Example}[section]
%% \newtheorem{property}{Property}[section]
%% \newtheorem{lemma}{Lemma}[section]
%% \newtheorem{theorem}{Theorem}[section]
%% \newtheorem{proposition}{Proposition}[section]

%% Aux.
\newcommand\defsrc[1]{}


%% The following macro seems broken wrt lmcs.
%\newcommand\defsrc[1]{{\color{gray}{As found in #1 of \cite{castellani1998testing}.}}}


%% TT shortcuts


%%%% The must-testing preorder symbol with the wave
\makeatletter
\newcommand{\subsetsim}{\mathrel{\mathpalette\subset@sim\relax}}
\newcommand{\subset@sim}[2]{%
  \vtop{\offinterlineskip\m@th
    \ialign{\hfil##\cr
      $#1\sqsubset$\cr\noalign{\kern0.5pt}\scalebox{0.9}{$#1\sim$}\cr
   }%
  }%
}
\makeatother
\newcommand\ssmust{\ensuremath{\subsetsim}}




%%%% Textual must such that \tmust{a}{b} = a must b
%\newcommand\tmust[2]{#1 \Must #2}
%%%% Alternative preorder \ff{a}{b} = a << b
%% \newcommand\ff{\mathrel{<\!\!\!<_\svr}}
%% \newcommand\Nff{\mathrel{\centernot{<\!\!\!<}_{\kern-3pt\svr}}}
%% \newcommand\ff[1][]{\ll_{#1}}%\mathrel{<\!\!\!<}}
%% \newcommand\Nff[1][]{\centernot{\ll_{#1}}}%{\mathrel{\centernot{<\!\!\!<}}}
%% \newcommand\ffsrv{\ff[\svr]}%\mathrel{<\!\!\!<_\svr}}
%% \newcommand\ffclt{\ff[\clt]}%\mathrel{<\!\!\!<_\clt}}
%% \newcommand\ffpeer{\ff[\pper]}%\mathrel{<\!\!\!<_\peer}}
%% \newcommand\ffbad{\ff[\bad]}%\mathrel{<\!\!\!<_\bad}}
%% \newcommand\ffsound{\ff[\sound]}%\mathrel{<\!\!\!<_\sound}}
%% \newcommand\ffcomp{\ff[2]}

%\newcommand\Act{\ensuremath{\textnormal{Act}}}
%%%% Alphabet of visible actions extended with internal action tau
%\newcommand\Actt{\ensuremath{\Act_{\tau}}\xspace}
%%%% Finite sequences from the alphabet of visible actions
%\newcommand\Acts{\ensuremath{\Act^{\star}}\xspace}


%%%% Acceptance sets
%\newcommand\Acceptance{\ensuremath{\mathcal{A}}}



%%%% strong reduce ⟶ with named reduction
%\newcommand\reducewith[1]{\ensuremath{\mathrel{\overset{#1} \longrightarrow}}}
%%%% strong reduce ⟶ₐ with named reduction +asynch
\newcommand{\ust}[1]{\ensuremath{\mathrel{\overset{#1} \longrightarrow_{{\not\ok}}}}}
%%%% does not strong reduce
%\newcommand\nreducewith[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\longrightarrow}}}}
%%%% weak reduction ⇒
%\newcommand\breducewith[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow}}}




%% strong transitions
\renewcommand{\st}[1]{\ensuremath{\mathrel{\overset{#1}\longrightarrow}}}
\newcommand{\stx}[1]{\xrightarrow{#1}}
\newcommand{\Nst}[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\longrightarrow}}}}
\newcommand{\stable}{\Nst{\tau}}



\newcommand{\wt}[1]{\ensuremath{\mathrel{\overset{#1}
      \Longrightarrow}}}
\newcommand{\wtx}[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow}}}
\newcommand{\uwt}[1]{\ensuremath{\mathrel{\overset{#1} \Longrightarrow_{\not\ok}}}}
\newcommand{\Nwt}[1]{\ensuremath{\mathrel{\overset{#1}{\longarrownot\Longrightarrow}}}}

\newcommand{\after}[2]{#1 \mathrel{\mathsf{after}} #2}

%\newcommand{\Oaftera}[2]{\bigoplus (#1 \aftera #2)}

%% \newcommand\States{\text{\mintinline{coq}{A}}}
%% \newcommand\StatesA{\text{\mintinline{coq}{A}}}
%% \newcommand\StatesB{\text{\mintinline{coq}{B}}}
%% \newcommand\StatesC{\text{\mintinline{coq}{C}}}
\newcommand\StatesA{A}
\newcommand\StatesB{B}
\newcommand\StatesC{C}
\newcommand\States{\StatesA}

%%%%%%%%% ILARIA: added macros 20/12/23

\newcommand{\SysStates}{\ensuremath{S}}
\newcommand{\sysstate}{\ensuremath{s}}

\newcommand\Sys{\textsc{Sys}}
\newcommand{\state}{p}
\renewcommand{\stateA}{p'}
\renewcommand{\stateB}{q}

\newcommand{\subst}[2]{[^{#1}/_{#2}]}

\newcommand{\C}{\mathcal{C}}

%\newcommand\rr[1]{\ensuremath{\rightsquigarrow_{#1}}}
\newcommand\rr[1]{\ensuremath{\stackrel{#1}{\rightsquigarrow}}}
\newcommand\rrbis[1]{\ensuremath{\rightrightarrows'_{#1}}}


\newcommand{\gen}[2]{g(#1, #2)}
\newcommand{\ttrace}[1]{t(#1)}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%% SYMBOLS FOR CLIENT GENERATORS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\testconvSym}{\mathit{tc}} %% test for convergence
\newcommand{\testconv}[1]{\testconvSym(#1)} %% test for convergence
\newcommand{\testaccSym}{\mathit{ta}} %% test for acceptance sets
\newcommand{\testacc}[2]{\testaccSym(#1,#2)} %% test for acceptance sets
\newcommand{\tacc}[2]{\testacc{#1}{#2}} %% test for acceptance sets

\newcommand{\aname}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\actor}[2]{\aname{#1}[#2]}

\newcommand{\genlts}{\mathcal{L}}
\newcommand{\lts}[3]{\ensuremath{\langle #1, #2, #3 \rangle}}

\newcommand{\reducts}[3]{\setof{ \stateA \in #2 }{ #1 #3{\tau} \stateA } }


\newcommand{\outactions}[1]{\setof{ \co{\aa} \in \co{\Names }}{ #1 \st{ \co{\aa}} } }
\newcommand{\inactions}[1]{\setof{ \aa \in \Names }{ #1 \st{  \aa} } }
\newcommand{\outset}[1]{O(#1) }
\newcommand{\inset}[1]{I(#1)}


\newcommand{\I}{I}
\newcommand{\J}{J}

\newcommand{\chopSym}{\mathsf{nf}}
\newcommand{\chop}[1]{\chopSym(#1)}

\newcommand{\goodperm}{\mathrel{\mathsf{perm}_g}}

%\newcommand{\mzkleq}{\leq_{\mathsf{mzk}}}

\newcommand{\LTSPar}{\Par}

%% input multiset
\newcommand{\imset}[1]{\mathsf{im}(#1)}
%% output multiset
\newcommand{\omset}[1]{\mathsf{om}(#1)}


%% \newcommand{\cdiv}{\ensuremath{\mathop{\mathsf{div}}}}
%% \newcommand{\Ncdiv}{\ensuremath{\centernot{\mathop{\mathsf{div}}}}}


\newcommand{\client}{r}
\newcommand{\server}{p}


\newcommand{\serverA}{p}
\newcommand{\serverB}{q}


%\newcommand{\tpcc}{\href{https://www.tpc.org/tpcc/}{TPC-C}\xspace}
\newcommand{\ofun}[1]{\bigcup \setof{ Z }{ Z \in #1 }}
\newcommand{\cpar}[2]{\csys{#1}{#2}}%{#1 \parallel #2}
\newcommand{\goodSym}{\textsc{good}}
\newcommand{\good}[1]{\goodSym(#1)}
\newcommand{\im}[2]{\mathit{IM}(#1, #2)}


\newcommand{\LTSs}{LTSs\xspace}

\newcommand{\asyn}{\textsf{asyn}}


%%% SETS OF MULTISETS
\newcommand{\MI}{\mathit{MI}}
\newcommand{\MO}{\mathit{MO}}


%% Set of LTSs of output-buffered agents with feedback
\newcommand{\oba}{\textsc{OBA}}%{\mathit{LTS}_{\textsc{OFb}}}
\newcommand{\obaFB}{\textsc{OF}}%{\mathit{LTS}_{\textsc{OFb}}}
\newcommand{\obaFW}{\textsc{OW}}%{\mathit{LTS}_{\textsc{OFb}}}

\newcommand{\liftFWSym}{\textsc{FW}}
\newcommand{\liftFW}[1]{\liftFWSym(#1)}

%% MACROS VANONI FOR SPACE SAVING ITEMIZE

%% \newenvironment{varitemize}
%% {
%% \begin{list}{\labelitemi}
%% {\setlength{\itemsep}{0pt}
%%  \setlength{\topseb
%% p}{0pt}
%%  \setlength{\parsep}{0pt}
%%  \setlength{\partopsep}{0pt}
%%  \setlength{\leftmargin}{15pt}
%%  \setlength{\rightmargin}{0pt}
%%  \setlength{\itemindent}{0pt}
%%  \setlength{\labelsep}{5pt}
%%  \setlength{\labelwidth}{10pt}
%% }}
%% {
%%  \end{list}
%% }






%%%%%%%%% DICTIONARY




\newcommand{\mustpreorder}{$\opMust$-preorder\xspace}
\newcommand{\mustequivalence}{$\opMust$-equivalence\xspace}

\newcommand{\svrclt}{client-server\xspace}

\newcommand{\nondeterminism}{nondeterminism\xspace}
\newcommand{\nondeterministic}{nondeterministic\xspace}

\newcommand{\nondeterminismT}{nondeterminism\xspace}
\newcommand{\nondeterministicT}{nondeterministic\xspace}

\newcommand{\MustSet}{$\opMust$-set\xspace}
\newcommand{\MustSets}{$\opMust$-sets\xspace}
\newcommand{\AcceptanceSet}{acceptance set\xspace}
\newcommand{\AcceptanceSets}{acceptance sets\xspace}


\newcommand{\barinduction}{bar-induction\xspace}
\newcommand{\Barinduction}{Bar-induction\xspace}

\newcommand{\intentional}{intensional\xspace}
\newcommand{\intentionally}{intensionally\xspace}
\newcommand{\Intentional}{Intensional\xspace}

\newcommand{\extensional}{extensional\xspace}
\newcommand{\extensionally}{extensionally\xspace}
\newcommand{\Extensional}{Extensional\xspace}

  \newcommand{\stripSym}{\mathsf{strip}}
\newcommand{\strip}[1]{\stripSym(#1)}


%%%%%%%%%%%%%%%%%% FURTHER STUFF



\newcommand{\ie}{{\em i.e.}\xspace}
\newcommand{\sts}[2]{\ensuremath{\langle #1, #2 \rangle}}
\newcommand{\myspace}{\phantom{\scalebox{.6}{$\ok$}}}
\newcommand{\ltsof}[1]{\ensuremath{\textsc{lts}(#1)}}
\newcommand{\ltsFWof}[1]{\ensuremath{\textsc{ltsFW}(#1)}}

\renewcommand{\traceA}{s_1}
\newcommand{\traceB}{s_2}
\newcommand{\traceC}{s_3}


\DeclareUnicodeCharacter{2208}{$\in$}
\DeclareUnicodeCharacter{2203}{$\exists$}
\DeclareUnicodeCharacter{2200}{$\forall$}
\DeclareUnicodeCharacter{2113}{$\ell$}
\DeclareUnicodeCharacter{03B1}{$\alpha$}
\DeclareUnicodeCharacter{27F6}{$\longrightarrow$}
\DeclareUnicodeCharacter{2227}{$\wedge$}
\DeclareUnicodeCharacter{2228}{$\vee$}
\DeclareUnicodeCharacter{2261}{$\equiv$}
\DeclareUnicodeCharacter{3BC}{$\mu$}
\DeclareUnicodeCharacter{2260}{$\neq$}
\DeclareUnicodeCharacter{27F9}{$\Longrightarrow$} %⟹ (U+27F9)
\DeclareUnicodeCharacter{03B7}{$\eta$} %η (U+03B7)
\DeclareUnicodeCharacter{03BB}{$\lambda$} %λ (U+03BB)
\DeclareUnicodeCharacter{03C4}{$\tau$} %λ (U+03BB)
\DeclareUnicodeCharacter{21D3}{$\Downarrow$}
\DeclareUnicodeCharacter{227C}{$\preccurlyeq$} %λ (U+03BB)
\DeclareUnicodeCharacter{2081}{${}_1$} %λ (U+03BB)
\DeclareUnicodeCharacter{2082}{${}_2$} %λ (U+03BB)
\DeclareUnicodeCharacter{2091}{${}_{\textrm{e}}$} %λ (U+03BB)
\DeclareUnicodeCharacter{219B}{$\nrightarrow$} %λ (U+03BB)
\DeclareUnicodeCharacter{2286}{$\subseteq$} %λ (U+03BB)
\DeclareUnicodeCharacter{2291}{$\sqsubseteq$} %λ (U+03BB)
\DeclareUnicodeCharacter{2205}{$\emptyset$} %λ (U+03BB)
\DeclareUnicodeCharacter{227E}{$\precsim$} %λ (U+03BB)
\DeclareUnicodeCharacter{25B7}{$\triangleright$} %λ (U+03BB)
\DeclareUnicodeCharacter{2194}{$\leftrightarrow$} %λ (U+03BB)
\DeclareUnicodeCharacter{2250}{$\doteq$} %λ (U+03BB)
\DeclareUnicodeCharacter{228E}{$\uplus$} %λ (U+03BB)
\DeclareUnicodeCharacter{27FF}{$\rightsquigarrow$} % ⟿
\DeclareUnicodeCharacter{22CD}{$\simeq$} %
\DeclareUnicodeCharacter{2216}{$\setminus$} %
\DeclareUnicodeCharacter{2093}{$_x$} %
\DeclareUnicodeCharacter{2913}{$\downarrow_i$} %
\DeclareUnicodeCharacter{22D6}{$\lessdot$} %
\DeclareUnicodeCharacter{2AB7}{$\precapprox$} %
\DeclareUnicodeCharacter{2A7D}{$\leq$} %


\newcommand{\mspreorder}{\ensuremath{\preceq_{MS}}}
\newcommand{\aspreorder}{\ensuremath{\preceq_{AS}}}
\newcommand{\outof}[1]{O(#1)}
\newcommand{\outnorm}[2]{\mathit{strip}(#1, #2)}
\newcommand{\outputmultisetSym}{\mathsf{mbox}}
\newcommand{\outputmultiset}[1]{\outputmultisetSym(#1)}

\newcommand{\WD}{\mathit{WD}}

\newcommand{\msetnow}{\rname{Mset-now}}
\newcommand{\msetstep}{\rname{Mset-step}}


\newcommand{\msleqtwo}{\preccurlyeq_{\textsc{m}}}



\renewcommand{\mustset}[2]{#1 \mathrel{\opMustset} #2}

\newcommand{\cnvleqset}{\mathrel{\preccurlyeq^{\mathsf{set}}_{\mathsf{cnv}}}}
\newcommand{\accleqset}{\mathrel{\preccurlyeq^{\mathsf{set}}_{\mathsf{acc}}}}
\newcommand{\Naccleqset}{\mathrel{{\not\preccurlyeq}^{\mathsf{set}}_{\mathsf{acc}}}}
\newcommand{\asleqset}{\mathrel{\preccurlyeq^{\mathsf{set}}_{\mathsf{AS}}}}
\newcommand{\Nasleqset}{\mathrel{\not\preccurlyeq^{\mathsf{set}}_{\mathsf{AS}}}}


\newcommand{\failleq}{\leq_{\textsf{fail}}}
\newcommand{\faileq}{=_{\textsf{fail}}}

